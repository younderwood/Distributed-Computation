# 局域网分布式运算

需要借鉴BOINC，Spark，Hapood，以及google的分布式运算思路

## 思路

分布式运算主要包括网络之间协议、任务分发、结果交互与反馈、进度的同步与统一以及节点任务中断或者主机中断后决策处理。为了支撑分布式运算的正常运行，需要局域网（也可以是处理器内的多核心之间）提供一定的网络带宽。

## 具体执行方式

> 任务分发

- 任务由算法主机发起（谁点开始运算就谁是主机，这里需要考虑每个主机）
- 开始后，主开始时会检查局域网或者网络中的在线用户，并发起链接进行任务分发，任务分发完成后各节点开始各自工作，在工作的过程中需要结果反馈，并如果突然中断或者出错误要进行错误处理。
- 运算过程中，节点上也需要结果显示，调整结果显示时间，可以以秒为单位同步。
- 如果主突然中断，任何一个节点可以成为主。（不一定能够实现）
- 需要考虑到每一个节点上计算量，或者将任务化的比较小，安排一部分，当节点完成之后，主机继续分发任务，这样不同性能的计算机处理任务的量就可以自己调整，运行快的PC处理完任务之后请求就会多发，运行慢的PC处理的慢请求量也会少，同时任务一定要分包并且互斥，同一块任务给一个人。
- 单个算法模块化即方便独立运算，输入参数的不同，反馈不同的结果，减少网络吞吐率。

分发任务的方式可以参考软件如何调用显卡进行运算的方式，利用显卡进行运算（例如浏览器进行硬件加速、视频软件进行编解码、一些挖矿软件或BOINC软件利用显卡进行运算等），即需要板卡对外自身提供驱动，外部设备对其进行调用。

> 结果的反馈

- 算法结果的反馈：由算法运算完毕之后向主机反馈结果
- 主机总体结果的回显以及反馈

> 节点任务中断

- 节点任务突然中断没来得及向主机反馈，主机在其他任务完成时，进行任务重新检查，并重新分发任务进行运算。

> 主机中断的处理方式

- 在每一个节点上都有主机任务的同步，如果主机未响应则由其他网内成员相互推荐产生新的主机进行替代功能（依照各个机器的性能来进行对比）。也可称之为“选举”

每个任务可以独立化，如果没有完成可以请求任务。

```flow
st=>start: Start|past:>http://www.google.com[blank]
e=>end: End:>http://www.google.com
op1=>operation: My Operation|past
op2=>operation: Stuff|current
sub1=>subroutine: My Subroutine|invalid
cond=>condition: Yes 
or No?|approved:>http://www.baidu.com
c2=>condition: Good idea|rejected
io=>inputoutput: catch something...|request

st->op1(right)->cond
cond(yes, right)->c2
cond(no)->sub1(left)->op1
c2(yes)->io->e
c2(no)->op2->e
```